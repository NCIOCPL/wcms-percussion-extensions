function cGovTinyMCEGlossify(e){cGovMassagedData=cGovPrepareStr(e);var t="<![CDATA["+cGovMassagedData+"]]>",o="<?xml version=\"1.0\"?><soapenv:Envelope xmlns:soapenv='http://schemas.xmlsoap.org/soap/envelope/' xmlns:m='"+cGovWSNameSpace+"'> <soapenv:Header/><soapenv:Body><m:glossify><m:fragment>"+t+"</m:fragment><m:dictionaries><m:string>Cancer.gov</m:string></m:dictionaries><m:languages><m:string>"+cGovLanguage+"</m:string></m:languages></m:glossify></soapenv:Body></soapenv:Envelope>";return cGovReq=new XMLHttpRequest,cGovStatusWindow=window.open("","","height=480,width=640"),cGovStatusWindow.document.write("<html><head><title>GlossifyDocumentPrep</title>"),cGovStatusWindow.document.write('<style type="text/css">H2 {COLOR: #333366; FONT-FAMILY: Trebuchet MS, Tahoma, Verdana, Arial, sans-serif; FONT-SIZE: 12px; FONT-WEIGHT: bold; LINE-HEIGHT: 14px}</style>'),cGovStatusWindow.document.write('<script language="javascript" type="text/javascript">'),cGovStatusWindow.document.write("var prg_width = 200;"),cGovStatusWindow.document.write("function progress() {"),cGovStatusWindow.document.write("var node = document.getElementById('progress');"),cGovStatusWindow.document.write("var w = node.style.width.match(/\\d+/);"),cGovStatusWindow.document.write("if (w == prg_width)"),cGovStatusWindow.document.write("w = 0;"),cGovStatusWindow.document.write("node.style.width = parseInt(w) + 5 + 'px';"),cGovStatusWindow.document.write("}"),cGovStatusWindow.document.write("setInterval(progress, 250);"),cGovStatusWindow.document.write("</script></head>"),cGovStatusWindow.document.write('<body><div><div style="border: 1px solid black; width:200px; height:10px;"><div id="progress" style="height:10px; width:0px; background-color:red;"/></div></div>'),cGovStatusWindow.document.write("<h2>Processing document, please wait.........</h2></body></html>"),cGovReq.onreadystatechange=cGovProcessReqChange,cGovReq.open("POST",cGovWebServiceURL,!0),cGovReq.setRequestHeader("Content-Type","text/xml; charset=utf-8"),cGovReq.setRequestHeader("SOAPAction",cGovSoapMethod),cGovReq.send(o),!0}function termObject(){this.start=0,this.length=0,this.docId="",this.dictionary="",this.language="",this.first=!0}function getElementsByTagNameNS(e,t,o,n){return elements=e.getElementsByTagName(o+":"+n),0==elements.length&&(elements=e.getElementsByTagName(n)),0==elements.length&&(elements=e.getElementsByTagNameNS(t,n)),elements}function cGovProcessReqChange(){if(4==cGovReq.readyState&&200==cGovReq.status){cGovStatusWindow.close();var e=getElementsByTagNameNS(cGovReq.responseXML,cGovSoapNameSpace,cGovSoapPrefix,"Envelope"),t=getElementsByTagNameNS(e[0],cGovSoapNameSpace,cGovSoapPrefix,"Body"),o=getElementsByTagNameNS(t[0],cGovWSNameSpace,cGovElementPrefix,"glossifyResponse"),n=getElementsByTagNameNS(o[0],cGovWSNameSpace,cGovElementPrefix,"glossifyResult"),a=getElementsByTagNameNS(n[0],cGovWSNameSpace,cGovElementPrefix,"Term"),i=cGovBuildTermsArray(a);cGovMassagedData=cGovBuildCBDisplayString(cGovMassagedData,i);var s=window.open("","","height=480,width=640,scrollbars=1");s.document.write("<html><head>"),s.document.write('<style type="text/css">H2 {COLOR: #333366; FONT-FAMILY: Trebuchet MS, Tahoma, Verdana, Arial, sans-serif; FONT-SIZE: 12px; FONT-WEIGHT: bold; LINE-HEIGHT: 14px}</style>'),s.document.write("</head>"),s.document.write('<script language="Javascript">'),s.document.write("function returnChecks() {"),s.document.write("	var checkArray = [];"),s.document.write("	if (document.Glossify.terms != null) {"),s.document.write("		var boxes = document.Glossify.terms.length;"),s.document.write("		if (boxes == null) {"),s.document.write("			if (document.Glossify.terms.checked) {"),s.document.write("				checkArray.push(document.Glossify.terms.value);"),s.document.write("			}"),s.document.write("		}"),s.document.write("		else {"),s.document.write("			for (i=0;i<boxes;i++) {"),s.document.write("				if (document.Glossify.terms[i].checked) {"),s.document.write("					checkArray.push(document.Glossify.terms[i].value);"),s.document.write("				}"),s.document.write("			}"),s.document.write("		}"),s.document.write("	}"),s.document.write("window.opener.submitter(checkArray);"),s.document.write("window.close();"),s.document.write("}\n</script>"),s.document.write("<body>"),s.document.write('<form name="Glossify" id="Glossify" onSubmit="returnChecks();return(false)">'),s.document.write("<h2>Please check/uncheck the word(s) you want glossified</h2>"),s.document.write("<hr>\n"+cGovMassagedData+"<hr>\n"),s.document.write('<input type="submit" value="Submit Changes">'),s.document.write("</form>\n</body>\n</html>")}}function submitter(e){var t=new RegExp("<input type=checkbox name=terms.+?value=.+?>"),o=new RegExp('<a __(?:new|old)term="(.+?)"(.+?)>(.+?)</a>'),n=new RegExp('<font __type="glossifyTemp".+?>(.+?)</font>'),a=new RegExp(cGovCRConst),i=new RegExp(cGovLFConst),s=cGovStripCheckboxes(t,cGovMassagedData);s=cGovFixFinalLinks(o,s,e),s=cGovKillFonts(n,s),s=cGovFixCRLF(a,s,"\r"),s=cGovFixCRLF(i,s,"\n"),_glossifyEditor.setContent(s)}function cGovStripCheckboxes(e,t){for(var o=!1,n=0;!o;){var a=t.substr(n);if(null==a)o=!0;else{var i=e.exec(a);null==i?o=!0:(n+=i.index,t=t.replace(i[0],""))}}return t}function cGovFixFinalLinks(e,t,o){for(var n=!1,a=0;!n;){var s=t.substr(a);if(null==s)n=!0;else{var r=e.exec(s);if(null==r)n=!0;else{a+=r.index;var c=!1;for(i=0;i<o.length;i++)if(o[i]==r[1]){c=!0;break}c?t=t.replace(r[0],"<a "+r[2]+">"+r[3]+"</a>"):(t=t.replace(r[0],r[3]),a+=r[3].length)}}}return t}function cGovKillFonts(e,t){for(var o=!1,n=0;!o;){var a=t.substr(n);if(null==a)o=!0;else{var i=e.exec(a);null==i?o=!0:(n+=i.index,t=t.replace(i[0],i[1]))}}return t}function cGovFixCRLF(e,t,o){for(var n=!1,a=0;!n;){var i=t.substr(a);if(null==i)n=!0;else{var s=e.exec(i);null==s?n=!0:(a+=s.index,t=t.replace(s[0],o))}}return t}function cGovBuildTermsArray(e){var t=[];for(i=0;i<e.length;i++){var o=new termObject,n=getElementsByTagNameNS(e[i],cGovWSNameSpace,cGovElementPrefix,"start");o.start=n[0].childNodes[0].nodeValue;var a=getElementsByTagNameNS(e[i],cGovWSNameSpace,cGovElementPrefix,"length");o.length=a[0].childNodes[0].nodeValue;var s=getElementsByTagNameNS(e[i],cGovWSNameSpace,cGovElementPrefix,"docId");o.docId=s[0].childNodes[0].nodeValue;var r=getElementsByTagNameNS(e[i],cGovWSNameSpace,cGovElementPrefix,"dictionary");o.dictionary=r[0].childNodes[0].nodeValue;var c=getElementsByTagNameNS(e[i],cGovWSNameSpace,cGovElementPrefix,"language");o.language=c[0].childNodes[0].nodeValue;var l=getElementsByTagNameNS(e[i],cGovWSNameSpace,cGovElementPrefix,"firstOccurrence");o.first=l[0].childNodes[0].nodeValue,t[i]=o}return t}function cGovBuildCBDisplayString(e,t){for(i=t.length-1;i>=0;i--){var o=t[i];cGovUniqueId++;var n,a=e.substr(0,parseInt(o.start)),s=e.substr(parseInt(o.start),parseInt(o.length)),r=e.substr(parseInt(o.start)+parseInt(o.length));n="es"==cGovLanguage?"Spanish":"English",e=a+"<input type=checkbox name=terms value="+cGovUniqueId+'><a __newterm="'+cGovUniqueId+'" class="definition" href="/Common/PopUps/popDefinition.aspx?id='+o.docId+"&version=Patient&language="+n+"\" onclick=\"javascript:popWindow('defbyid','"+o.docId+"&version=Patient&language="+n+"'); return false;\">"+s+"</a>"+r}var c=new RegExp('<a __(?:new|old)term=".+?>(.+?)</a>');return e=cGovDoRegExpFonts(c,e),rxOldterm=new RegExp('<a __oldterm="(.+?)"'),e=cGovDoRegExpAddChecks(rxOldterm,e)}function cGovPrepareStr(e){var t=e,o="",n=new RegExp('<a\\s+(class="definition".+?>.+?</a>)'),a=new RegExp('<a\\s+(onclick="javascript:popWindow.+?href=.+?dictionary/db_alpha.aspx.+?</a>)',"i"),i=new RegExp('<a\\s+(onclick="javascript:popWindow.+?href=.+?popDefinition.aspx.+?</a>)'),s=new RegExp('<a\\s+(href="/Common/PopUps/popDefinition.aspx.+?</a>)');t=cGovDoRegExp1(a,t),t=cGovDoRegExp1(i,t),t=cGovDoRegExp1(n,t),t=cGovDoRegExp1(s,t);for(var r=0;r<t.length;r++){var c=t.charAt(r);o+="\n"==c?cGovLFConst:"\r"==c?cGovCRConst:"”"==c?"&#148;":"—"==c?"&#151;":"–"==c?"&#150;":"Á"==c?"&#193;":"Í"==c?"&#205;":c}return o}function cGovDoRegExp1(e,t){for(var o=!1,n=0;!o;){var a=t.substr(n);if(null==a)o=!0;else{var i=e.exec(a);if(null==i)o=!0;else{n+=i.index;var s=cGovAddUniqueID(i[1]);t=t.replace(i[0],s),n+=s.length}}}return t}function cGovDoRegExpAddChecks(e,t){for(var o=!1,n=0;!o;){var a=t.substr(n);if(null==a)o=!0;else{var i=e.exec(a);if(null==i)o=!0;else{n+=i.index;var s="<input type=checkbox name=terms checked value="+i[1]+">"+i[0];t=t.replace(i[0],s),n+=s.length}}}return t}function cGovDoRegExpFonts(e,t){for(var o,n=!1,a=0,i=[];!n;){var s=t.substr(a),r=t.substr(0,a);if(null==s)n=!0;else{var c=e.exec(s);if(null==c)n=!0;else{var l=!1;for(j=0;j<i.length;j++)if(i[j]==c[1].toLowerCase()){l=!0;break}l?a+=c.index+c[0].length:(i.push(c[1].toLowerCase()),o='<font __type="glossifyTemp" style="background-color: #ffff00;">'+c[1]+"</font>",s=s.replace(c[1],o),a+=c.index+c[0].length+o.length-c[1].length),t=r+s}}}return t}function cGovAddUniqueID(e){cGovUniqueId++;var t='<a __oldterm="'+cGovUniqueId+'" '+e;return t}var cGovReq,cGovOriginalData,cGovMassagedData,cGovUniqueId,cGovEditorName,cGovStatusWindow,cGovCheckboxWindow,cGovCRConst="&#x000d;",cGovLFConst="&#x000a;",cGovWebServiceURL="/GlossifierProxy/services/GlossifierProxy.GlossifierSoap/",cGovPreviewURL="www.cancer.gov",cGovElementPrefix="ns1",cGovSoapPrefix="soapenv",cGovSoapNameSpace="http:?/?/?schemas.xmlsoap.org/?soap/?envelope/",cGovWSNameSpace="cancer.gov/glossproxy",cGovSoapMethod="cancer.gov/glossproxy/glossify",cGovIsEnglish=!0,cGovLanguage=document.documentElement.lang.split("-")[0],_glossifyEditor;tinymce.PluginManager.add("glossifier",function(e){var t=e.settings,o="<b>cancer</b>";e.addCommand("openGlossifier",function(){o=e.getContent(),cGovUniqueId=0,cGovLanguage="es"==t.language?t.language:"en",_glossifyEditor=e,cGovTinyMCEGlossify(o)}),e.addButton("glossifier",{icon:'glossifier" style="background-image:url(\'../rx_resources/tinymce/images/glossify.gif\');"',title:"Glossify",cmd:"openGlossifier"}),e.addMenuItem("glossifier",{icon:'glossifier" style="background-image:url(\'../rx_resources/tinymce/images/glossify.gif\');"',text:"Glossify",cmd:"openGlossifier",context:"tools"})});