<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:aop="http://www.springframework.org/schema/aop"
	xmlns:lang="http://www.springframework.org/schema/lang"
	xmlns:util="http://www.springframework.org/schema/util"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd
		http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.1.xsd
		http://www.springframework.org/schema/lang http://www.springframework.org/schema/lang/spring-lang-2.0.xsd
		http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-2.0.xsd">

	<!-- This bean defines extra configuration information about content types in the system -->
	<!-- If a content type is not defined in the map, then the Default config will be used -->
	<!-- Constructor Arguments: 
			1. The name of the content type
			2. Is the content type a top type
			3. Does the content type require that the parent navons have a public revision
			
	-->
	<bean id="ContentTypesConfig" class="gov.cancer.wcm.workflow.ContentTypesConfigCollection">
		<constructor-arg>
			<list>
				<bean class="gov.cancer.wcm.workflow.ContentTypeConfig">
					<constructor-arg><value>nciGeneral</value></constructor-arg>
					<constructor-arg><value>true</value></constructor-arg>
					<constructor-arg><value>true</value></constructor-arg>
				</bean>
			</list>
		</constructor-arg>
		<constructor-arg>
			<bean class="gov.cancer.wcm.workflow.ContentTypeConfig">
				<constructor-arg><value>default</value></constructor-arg>
				<constructor-arg><value>false</value></constructor-arg>
				<constructor-arg><value>false</value></constructor-arg>
			</bean>
		</constructor-arg>
	</bean>
	
	<!-- This section defines the RelationshipWFTransitionStopCondition classes so they
		may be referenced in the RelationshipWFTransitionChecks below.	
	-->
	<!-- RelationshipWFTransitionStopCondition to check if the dependent is not a Top Type or
		is a Top Type with a public revision.
	 -->
	<bean id="TopTypeRelationshipWFTransitionStopCondition" class="gov.cancer.wcm.workflow.TopTypeRelationshipWFTransitionStopCondition" />

	<!-- RelationshipWFTransitionStopCondition to check if the dependent is not shared or
		is shared with a public revision.
	 -->
	<bean id="SharedRelationshipWFTransitionStopCondition" class="gov.cancer.wcm.workflow.SharedRelationshipWFTransitionStopCondition" />

	<!-- RelationshipWFTransitionStopCondition to check if the dependent is not in another community or
		is in another community with a public revision.
	 -->
	<bean id="OtherCommunityRelationshipWFTransitionStopCondition" class="gov.cancer.wcm.workflow.OtherCommunityRelationshipWFTransitionStopCondition" />

	<!-- RelationshipWFTransitionStopCondition to check if the dependent uses another workflow or
		uses another workflow with a public revision.
	 -->
	<bean id="OtherWorkflowRelationshipWFTransitionStopCondition" class="gov.cancer.wcm.workflow.OtherWorkflowRelationshipWFTransitionStopCondition" />

	<!-- RelationshipWFTransitionStopCondition to check if a dependent is checked out by another user. 
		this is not a condition which is ok to continue.
	-->
	<bean id="OtherUserLockedRelationshipWFTransitionStopCondition" class="gov.cancer.wcm.workflow.OtherUserLockedRelationshipWFTransitionStopCondition" />

	<!-- RelationshipWFTransitionStopCondition to check the dependent's relationships.
	 -->
	<bean id="DependentsCheckRelationshipWFTransitionStopCondition" class="gov.cancer.wcm.workflow.DependentsCheckRelationshipWFTransitionStopCondition" />

		
	<!-- Defines configuration for relationships -->
	<!-- Bean class types define how we should handle child items:
	   RelationshipWFTransitionFollowCheck => 
		          The dependents of the relationship should be transitioned with the owner
			       if the business rules allow. If the dependent meets a stop condition 
					 then it will follow the rules of the CGV_RelationshipWFTransitionStopConfig.
		RelationshipWFTransitionStopCheck => 
		        The dependents of the relationship will not be transitioned with the owner,
		        furthermore, the transition of the owner will stop if any dependents do not
			     have a public revision.
	    RelationshipWFTransitionIgnoreCheck => 
					 The dependents of the relationship will not be transition with the
		          owner, and the transition will not stop if the dependent does not have a
			       public revision.  This is the out of the box behavior of Percussion.
	-->
	<bean id="RelationshipChecks" class="gov.cancer.wcm.workflow.RelationshipWFTransitionChecksCollection">
		<constructor-arg>
			<list>
				<bean class="gov.cancer.wcm.workflow.RelationshipWFTransitionFollowCheck">
					<constructor-arg><value>CDE</value></constructor-arg>
					<constructor-arg>
						<list>
							<ref bean="OtherCommunityRelationshipWFTransitionStopCondition" />
							<ref bean="TopTypeRelationshipWFTransitionStopCondition" />
							<ref bean="OtherWorkflowRelationshipWFTransitionStopCondition" />							
							<ref bean="SharedRelationshipWFTransitionStopCondition" />
							<ref bean="OtherUserLockedRelationshipWFTransitionStopCondition" />
							<ref bean="DependentsCheckRelationshipWFTransitionStopCondition" />
						</list>
					</constructor-arg>
				</bean>
				<bean class="gov.cancer.wcm.workflow.RelationshipWFTransitionFollowCheck">
					<constructor-arg><value>Pages</value></constructor-arg>
					<constructor-arg>
						<list>
							<ref bean="OtherCommunityRelationshipWFTransitionStopCondition" />
							<ref bean="TopTypeRelationshipWFTransitionStopCondition" />
							<ref bean="OtherWorkflowRelationshipWFTransitionStopCondition" />							
							<ref bean="SharedRelationshipWFTransitionStopCondition" />
							<ref bean="OtherUserLockedRelationshipWFTransitionStopCondition" />
							<ref bean="DependentsCheckRelationshipWFTransitionStopCondition" />
						</list>
					</constructor-arg>
				</bean>				
			</list>
		</constructor-arg>
		<constructor-arg>
			<bean class="gov.cancer.wcm.workflow.RelationshipWFTransitionStopCheck">
				<constructor-arg><value>default</value></constructor-arg>
			</bean>
		</constructor-arg>
	</bean>
	
	<!-- MAIN BEAN -->
	<!-- This bean defines workflow configuration information -->		
	<bean id="CGV_WorkflowConfiguration" class="gov.cancer.wcm.workflow.WorkflowConfiguration">
		<constructor-arg><ref bean="ContentTypesConfig"/></constructor-arg>
		<constructor-arg><ref bean="RelationshipChecks"/></constructor-arg>
	</bean>
</beans>